# éœ€æ±‚åˆ†æ

![image-20240827151934039](imgFiles/image-20240827151934039.png)

![image-20240827152118448](imgFiles/image-20240827152118448.png)

![image-20240827152407745](imgFiles/image-20240827152407745.png)

# ç³»ç»Ÿè®¾è®¡ä¸é¡¹ç›®åˆå§‹åŒ–

> UIè®¾è®¡è§„èŒƒï¼šã€ŠUIè®¾è®¡è§„èŒƒã€‹
>
> éœ€æ±‚è®¾è®¡è§„èŒƒï¼šã€Šéœ€æ±‚è®¾è®¡è§„èŒƒã€‹ã€Šä¸šåŠ¡éœ€æ±‚æ–‡æ¡£ã€‹

## åˆ›å»ºé¡¹ç›®

```git
npx create-react-app react-travel --template typescript
```

## css in JS

çœ‹reactä¸­çš„ç¬”è®°

## å¼•å…¥UIæ¡†æ¶

```cmd
npm install antd @ant-design/icons
```

åœ¨index.tsxä¸­å…¨å±€å¯¼å…¥antd design

```jsx
import "antd/dist/reset.css";
```

ç»„ä»¶åŒ–æ“ä½œ

åˆ›å»ºcomponentså’Œassetsæ–‡ä»¶å¤¹

åœ¨componentsä¸­ä¸ºæ¯ä¸ªç»„ä»¶åˆ›å»ºæ–‡ä»¶å¤¹ æ–‡ä»¶å¤¹ä¸­åŒ…å«ä¸‰ä¸ªæ–‡ä»¶

- ç»„ä»¶å.module.css 

- ç»„ä»¶å.tsx

- index.ts

  åœ¨index.tsä¸­å®ç°å¯¼å‡ºç»„ä»¶

  ```jsx
  export * from "./ç»„ä»¶å"
  ```

  åœ¨componentsæ–‡ä»¶å¤¹ä¸­åˆ›å»ºindex.js

  å®ç°ç»Ÿä¸€å¯¼å‡ºç»„ä»¶æ–‡ä»¶å¤¹

  ```jsx
  export * from "./footer";
  export * from "./header";
  ```

  åœ¨App.tsxä¸­å°±å¯ä»¥å®ç°æ›´ä¸ºç®€ä¾¿çš„å¼•å…¥äº†

  ```jsx
  import { Header, Footer } from "./components";
  
  ```

## åˆ›å»ºä¸»é¡µçš„å„ä¸ªç»„ä»¶ 

åœ¨componentsæ–‡ä»¶å¤¹ä¸­

# å¼€å¯è·¯ç”±é…ç½® 

å»ºpagesæ–‡ä»¶å¤¹ å°†åˆ›å»ºå¥½çš„homepageå†…å®¹è¿ç§»è‡³pages/homePages folder

# å®ç°æŒ‰é’®ç‚¹å‡»è·³è½¬é¡µé¢

ä½¿ç”¨useNavigate

```tsx
const navigate = useNavigate();
<span onClick={() => navigate("/")}>
  ...
</span>
```

# å®ç°å›¾ç‰‡ç‚¹å‡»è·³è½¬

ä½¿ç”¨<Link>ç»„ä»¶åŒ…è£¹åŸç»„ä»¶

```jsx
<Link to={`/detail/${id}`}>
```

# å®ç°ç±»ç»„ä»¶ä¸­ä½¿ç”¨hook*

src / helpers / withRouter.tsx

```jsx
import { useNavigate, NavigateFunction } from "react-router-dom";

// å®šä¹‰å±æ€§
export interface RouteComponentProps {
  navigate: NavigateFunction;
}

export const withRouter = (Component) => {
  const Wrapper = (props) => {
    const navigate = useNavigate();
    return <Component navigate={navigate} {...props} />;
  };
  return Wrapper;
};
```

```jsx
class HomePageComponent extends React.Component<RouteComponentProps> {
  render(): React.ReactNode {
    console.log(this.props.navigate);
}
// ä½¿ç”¨é«˜é˜¶ç»„ä»¶åŒ…è£¹
export const HomePage = withRouter(HomePageComponent);
```

# [i18nå›½é™…åŒ–](https://react.i18next.com/guides/quick-start)

```jsx
npm install react-i18next i18next --save
```

## Configure i18next

- åˆ›å»º`i18n` folder
- åˆ›å»º config.ts

```jsx
import i18n from "i18next";
import { initReactI18next } from "react-i18next";

import translation_en from "./en.json";
import translation_zh from "./zh.json";

const resources = {
  en: {
    translation: translation_en,
  },
  zh: {
    translation: translation_zh,
  },
};
i18n
  .use(initReactI18next) // passes i18n down to react-i18next
  .init({
    resources,
    lng: "zh", // language to use, more information here: https://www.i18next.com/overview/configuration-options#languages-namespaces-resources
    // you can use the i18n.changeLanguage function to change the language manually: https://www.i18next.com/overview/api#changelanguage
    // if you're using a language detector, do not define the lng option

    interpolation: {
      escapeValue: false, // react already safes from xss
    },
  });

export default i18n;

```

- ç²˜è´´è¯­è¨€æ–‡ä»¶ `zn.json` ã€`en.json`åˆ° `i18n` folder

#### using in class Component

- `withTranslation`: å¼•å…¥é«˜é˜¶ç»„ä»¶(wå°å†™)
- `WithTranslation`:TypeScript æ¥å£ç±»å‹,ç”¨äºå®šä¹‰ withTranslation HOC æ³¨å…¥åˆ°ç»„ä»¶ä¸Šçš„é¢å¤–å±æ€§ã€‚
- å½“æˆ‘ä»¬å®Œæˆi18nçš„é«˜é˜¶ç»„ä»¶ä»¥åï¼Œ`headerComponent`å°±ä¼šå‘`props`ä¸­è¿½åŠ ä¸€ä¸ªå«åštçš„å‡½æ•°ï¼Œt å°±æ˜¯ translation çš„ç¼©å†™ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°ä»¥å­—ç¬¦ä¸²çš„å½¢å¼æ¥è®¿é—®è¯­è¨€æ–‡ä»¶ä¸­çš„jsonå¯¹è±¡ã€‚

```jsx
import "./i18n/configs"
import { withTranslation, WithTranslation } from "react-i18next";

class HeaderComponent extends React.Component<RouteComponentProps & WithTranslation, State> {
  return{
    render(
			  <Button onClick={() => navigate("/register")}>
  				{t("header.register")}
				</Button>}
    )
	}
}

export const Header = withTranslation()(withRouter(HeaderComponent));
//ç¬¬ä¸€æ‹¬å·ä»£è¡¨é…ç½®è¯­è¨€æ‰€ä½¿ç”¨çš„å‘½åç©ºé—´ï¼Œè€Œç¬¬äºŒä¸ªæ‹¬å·æ‰æ˜¯æˆ‘ä»¬çš„ç»„ä»¶
```

## Using the hook

```jsx
import { useTranslation } from "react-i18next";

export const Footer: React.FC = () => {
  const { t } = useTranslation();
  return (
    <div>
      {t("footer.detail")}
    </div>
  );
};
```

# react-redux

<img src="imgFiles/image-20240830132723089.png" alt="image-20240830132723089" style="zoom:67%;" />

redux ï¼šç»„ä»¶å¯¹åº”çš„reduceræ–‡ä»¶å¤¹ã€hooksã€store

## store

- rootStore
- store
- type RootState

```jsx
import { createStore, combineReducers } from "redux";
import languageReducer from "./language/languageReducer";
import recommendProductsReducer from "./recommendProducts/recommendProductsReducer";

const rootReducer = combineReducers({
  language: languageReducer,
  recommendProducts: recommendProductsReducer,
});

const store = createStore(rootReducer);

export type RootState = ReturnType<typeof store.getState>;

export default store;

```

## å‡½æ•°ç»„ä»¶

### åˆ›å»º `ActionCreator `function

è¿”å›å€¼æ˜¯ä¸€ä¸ª`actionå¯¹è±¡`ï¼Œè¦åŒ…å« `type` å’Œ `payload` å±æ€§

```jsx
export const CHANGE_LANGUAGE = "change_language";

// å®šä¹‰ç±»å‹
export interface ChangeLanguageAction {
  type: typeof CHANGE_LANGUAGE;
  payload: "zh" | "en";
}

export const changeLanguageActionCreator = (
  languageCode: "zh" | "en"
): ChangeLanguageAction => {
  return {
    type: CHANGE_LANGUAGE,
    payload: languageCode,
  };
};
```

### åˆ›å»º `reducer`

è¦æ±‚æŒ‡å®šåˆ›å»º `initial stateå¯¹è±¡` å’Œ `reducer function` 

- æ¯ä¸€ä¸ª`case`ä¸­è¦ `return æ–°çš„state`,ä½¿ç”¨ è§£æ„èµ‹å€¼{...}

```jsx
/**
 * reducer åˆ›å»ºå¹¶å¯¼å‡º
 * åœ¨storeæ–‡ä»¶ä¸­è¢«å¼•å…¥
 */
import i18n from "../../i18n/config";
import { CHANGE_LANGUAGE, ChangeLanguageAction } from "./languageActions";

export interface LanguageState {
  language: "en" | "zh";
  languageList: { name: string; code: string }[];
}
// å®šä¹‰é»˜è®¤state
const defaultState: LanguageState = {
  language: "zh",
  languageList: [
    { name: "ä¸­æ–‡", code: "zh" },
    { name: "English", code: "en" },
  ],
};

export default (state = defaultState, action: ChangeLanguageAction) => {
  switch (action.type) {
    case CHANGE_LANGUAGE:
      i18n.changeLanguage(action.payload);
      return { ...state, language: action.payload };
    default:
      return state;
  }
};
```

### 1. å®šä¹‰æ ¹ state å’Œ dispatch ç±»å‹

```jsx
//store.ts
import { createStore } from "redux";
import languageReducer from "./language/languageReducer";

const store = createStore(languageReducer);

export type RootState = ReturnType<typeof store.getState>;

export default store;
```

```jsx
//  ç›´æ¥åœ¨ç»„ä»¶ä¸­
const dispatch = useDispatch<Dispatch<ChangeLanguageAction>>();
```

### 2. åˆ›å»ºhooksæ–‡ä»¶

å•ç‹¬åˆ›å»º`hooks.ts`åœ¨reduxæ–‡ä»¶å¤¹ä¸­ï¼Œå¯¹äº `useSelector`ï¼Œå®ƒçœå»äº†æ‚¨æ¯æ¬¡éƒ½é”®å…¥ `(state: RootState)` çš„éœ€è¦

```jsx
import {
  useSelector as useReduxSelector,
  TypedUseSelectorHook,
} from "react-redux";
import { RootState } from "./store";

export const useSelector: TypedUseSelectorHook<RootState> = useReduxSelector;
```

### 3. ä½¿ç”¨hooks

- `useSelector`: ç”¨äºè·å– state
- `useDispatch`: ç”¨äºæ´¾å‘ acion

```jsx
// æ¥è‡ªè‡ªå®šçš„hooksæ–‡ä»¶
import { useSelector } from "../../redux/hooks";
// æ¥è‡ªreact-redux
import { useDispatch } from "react-redux";

const language = useSelector((state) => state.language);
  const languageList = useSelector((state) => state.languageList);
  const dispatch = useDispatch<Dispatch<ChangeLanguageAction>>();

  const onClick = (e) => {
    dispatch(changeLanguageActionCreator(e.key));
  };

<a onClick={(e) => e.preventDefault()}>
  {language === "zh" ? "ä¸­æ–‡" : "English"}
</a>
```

```jsx
import { Provider } from "react-redux";
import store from "./redux/store";    

<Provider store={store}>
  <App />
</Provider>
```

## ç±»ç»„ä»¶

> éœ€è¦ç”¨åˆ° `connect `å‡½æ•°(æ¥è‡ªreact-redux) å’Œ `è‡ªå®šä¹‰ä¸¤ä¸ªå‡½æ•°`å®ç°å°†`state`å’Œ`action`æ´¾å‘åˆ°`props`ä¸­



### mapStateToProps

```jsx
const mapStateToProps = (state: RootState) => {
  return {
    language: state.language.language,
    languageList: state.language.languageList,
  };
};
```

### mapDispatchToProps

```jsx
const mapDispatchToProps = (dispatch) => {
  return {
    changeLanguage: (code: "zh" | "en") => {
      const action = changeLanguageActionCreator(code);
      dispatch(action);
    },
  };
};
```

# AJAXå¼‚æ­¥è·å–æ•°æ®

åœ¨`HomePage`çš„`componentDidMount `ä¸­åˆ©ç”¨`axios`å®Œæˆå¼‚æ­¥æ•°æ®è·å–

```jsx
// ğŸ”´ å®šä¹‰æ¥å£
interface State {
  loading: boolean; //å¤„ç†æ‚¬ç©ºæ•°æ®
  error: string | null;
  productList: any[];
}  

async componentDidMount() {
    try {
      const { data } = await axios.get(
        "http://82.157.43.234:8080/api/productCollections",
        {/*headers:*/}
      );
      /* ğŸ”´å¤„ç†æ‚¬ç©ºæ•°æ® */
      this.setState({ productList: data, loading: false, error: null });
    } catch (error) {
      if (error instanceof Error) {
        this.setState({ error: error.message, loading: false });
      }
    }
  }
```

åœ¨æ„é€ å‡½æ•°ä¸­å®Œæˆç»„ä»¶çš„åˆå§‹åŒ–

```jsx
  constructor(props) {
    super(props);
    this.state = {
      loading: true,
      error: null,
      productList: [],
    };
  }
```

**è¯·æ±‚å¤´Tips** 

- ç›´æ¥åœ¨ç½‘ç«™çš„æœ€åˆå…¥å£`ndex.ts`ä¸­æ”¾å…¥è¯·æ±‚å¤´ï¼Œé¿å…å¤šæ¬¡é‡å¤ä»£ç 

```tsx
axios.defaults.headers["x-icode"] = "2A95A6614213A21A";
```

## **å¦‚ä½•å¤„ç†æ‚¬ç©ºæ•°æ®**

- `æ‚¬ç©ºæ•°æ®`æŒ‡çš„æ˜¯é¡µé¢æ¸²æŸ“è™šæ‹ŸDOMæ—¶è¿˜æœªæŒ‚è½½å¯¼è‡´æ— æ³•å±•ç¤ºé¡µé¢

1. åœ¨é¡µé¢æ¥å£ä¸­æ·»åŠ ä¸€ä¸ª`loading `æ•°æ®ç±»å‹ä¸º`boolean`

   ```tsx
   interface State {
     loading: boolean;
   	...
   }
   ```

2. åœ¨`ComponentDidMount`ä¸­åˆ©ç”¨`try catch`è¿›è¡Œåˆ¤æ–­(ä»£ç è§ä¸Šé¢å¼‚æ­¥è¯·æ±‚)

   - å½“å®ƒåœ¨tryä¸­ åˆ™ä¸ºtrue
   - å½“å®ƒåœ¨catchä¸­ åˆ™ä¸ºfalse

3. é’ˆå¯¹ä¸åŒçš„booleanå€¼æ˜¾ç¤ºä¸åŒçš„ç»„ä»¶

   - å¼•å…¥`Spin`ç»„ä»¶ ï¼ˆè½¬åœˆçš„å›¾æ ‡ï¼‰

   ```jsx
   import { Spin } from "antd";
   ```

   - åœ¨renderä¸­æ·»åŠ åŠ è½½æ—¶çš„æ ·å¼

   ```jsx
   if (loading) {
         return (
           <Spin
             size="large"
             style={{
               marginTop: 200,
               marginBottom: 200,
               marginLeft: "auto",
               marginRight: "auto",
               width: "100%",
             }}
           />
         );
       }
       if (error) {
         return <div>ç½‘ç«™å‡ºé”™ï¼š{error}</div>;
       }
   ```

- æ— çŠ¶æ€

- é¢å‘"èµ„æº"

  - api/v1/touristRoutes âœ”ï¸
  - api/v1/GetTouristRoutes âŒ

- ä½¿ç”¨HTTPçš„åŠ¨è¯

  ![image-20240829160642678](imgFiles/image-20240829160642678.png)

# MVC convert to Redux

## MVC

Reacté¡¹ç›®å¹¶ä¸æå€¡ä½¿ç”¨MVCæ¶æ„

- ä¸€ç§æ¶æ„æ¨¡å¼ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ç§æ€æƒ³
- ç”±æ¨¡å‹(Model)ã€è§†å›¾(View)å’Œæ§åˆ¶å™¨(Controller)æ„æˆ
- ä½œç”¨äºåˆ†ç¦»ä¸šåŠ¡æ“ä½œã€UIæ˜¾ç¤ºã€é€»è¾‘æ§åˆ¶

### è§†å›¾View

- ç”¨æˆ·äº¤äº’ç•Œé¢
- ä»…ç”¨äºæ•°æ®å±•ç¤º ä¸å¤„ç†æ•°æ®
- Reacté¡¹ç›®ä¸­çš„JSXä»£ç 

### æ¨¡å‹Model

- MVCæ¶æ„æ ¸å¿ƒ
- è¡¨ç¤ºä¸šåŠ¡æ¨¡å‹æˆ–æ•°æ®æ¨¡å‹
- ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚ç®—æ³•å®ç°ã€æ•°æ®çš„ç®¡ç†ã€è¾“å‡ºå¯¹è±¡çš„å°è£…ç­‰ç­‰

### æ§åˆ¶å™¨Controller

- æ¥å—ç”¨æˆ·çš„è¾“å…¥ï¼Œå¹¶è°ƒç”¨æ¨¡å‹å’Œè§†å›¾å»å®Œæˆç”¨æˆ·çš„è¯·æ±‚å¤„ç†
- ä¸å¤„ç†æ•°æ®
- React -> MVVM

## Redux

![image-20240829193722824](imgFiles/image-20240829193722824.png)

# redux-thunk

- Moving complex logic out of components
- Making async requests or other async logic

![image-20240830152715722](imgFiles/image-20240830152715722.png)

![image-20240830160136326](imgFiles/image-20240830160136326.png)

Reduxä¸­é—´ä»¶å…¬å¼

```jsx
const middleware = (store) => (next) =>(action)  => {}
```

# layouts

å¤§å¤šæ•°é¡µé¢éƒ½åŒ…å«Header å’Œ Footer ç»„ä»¶ æˆ‘ä»¬å¯ä»¥å°è¯•æŠŠä»–ä»¬æå–å‡ºæ¥ æ”¾ç½®åœ¨layouts/MainLayout folderä¸­

`MainLayout` ç»„ä»¶ä½œä¸ºä¸€ä¸ªå¸ƒå±€å®¹å™¨ï¼Œå¯ä»¥è¢«ç”¨äºåŒ…è£¹ä½ çš„é¡µé¢ç»„ä»¶ã€‚è¿™æ ·ï¼Œä½ å¯ä»¥åœ¨ `MainLayout` ä¸­å®šä¹‰é¡µé¢çš„å…±åŒç»“æ„ï¼ˆå¦‚å¤´éƒ¨ã€å°¾éƒ¨ç­‰ï¼‰ï¼Œè€Œå…·ä½“çš„é¡µé¢å†…å®¹åˆ™é€šè¿‡ `children` ä¼ é€’ç»™ `MainLayout`ã€‚

```jsx
export const MainLayout: React.FC<PropsType> = ({ children }) => {
  return (
    <div>
      <Header />  {/* å¤´éƒ¨ç»„ä»¶ */}
      <div className={styles["page-content"]}>
        {children}  {/* è¿™é‡Œå°†ä¼šæ¸²æŸ“ä¼ å…¥çš„å­å…ƒç´  */}
      </div>
      <Footer />  {/* å°¾éƒ¨ç»„ä»¶ */}
    </div>
  );
};
```

# å•ç‚¹ç™»å½•ä¸JWT

![image-20240902185813554](imgFiles/image-20240902185813554.png)



ç”¨æˆ·è®¤è¯ï¼šæŒ‡çš„æ˜¯ä½¿ç”¨ç”¨æˆ·åã€å¯†ç æ¥éªŒè¯å½“å‰ç”¨æˆ·çš„èº«ä»½ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·ç™»å½•

- é”™è¯¯çŠ¶æ€ç ï¼š401 Unauthorized(æœªæˆæƒ)

ç”¨æˆ·æˆæƒï¼š æŒ‡çš„æ˜¯å½“å‰ç”¨æˆ·æœ‰è¶³å¤Ÿçš„æƒé™è®¿é—®ç‰¹å®šçš„èµ„æº

- é”™è¯¯çŠ¶æ€ç ï¼š403 forbidden(ç¦æ­¢è®¿é—®)

ä½¿ç”¨æœåŠ¡å™¨çš„sessionåˆ¤æ–­ ç”¨æˆ·æ˜¯å¦ç™»å½•

- ç”¨æˆ·ç™»å½•åï¼ŒæœåŠ¡å™¨ä¼šä¿å­˜ç™»å½•çš„sessionä¿¡æ¯
- Session ID ä¼šé€šè¿‡cookieä¼ é€’ç»™å‰ç«¯
- å½“ç”¨æˆ·éœ€è¦è®¿é—®æŸä¸ªAPIçš„æ—¶å€™ï¼Œç”¨æˆ·çš„session IDå°±ä¼šè¢«åŒ…å«åœ¨httpè¯·æ±‚ä¸­

JWT ä¿¡æ¯åªéœ€è¦ä¿å­˜åœ¨å®¢æˆ·ç«¯ æ— çŠ¶æ€ç™»å½•

![image-20240902191227734](imgFiles/image-20240902191227734.png)

![image-20240902191400363](imgFiles/image-20240902191400363.png)

![image-20240902191434575](imgFiles/image-20240902191434575.png)

![image-20240902192244299](imgFiles/image-20240902192244299.png)

jwt è§£ç å·¥å…·

```jsx
npm install jwt-decode
```

```jsx
import { jwtDecode, JwtPayload as DefaultJwtPayLoad} from "jwt-decode";

```

# ç™»å½•æŒä¹…åŒ–

![image-20240902210007230](imgFiles/image-20240902210007230.png)

JWT æ— session 

![image-20240902210048018](imgFiles/image-20240902210048018.png)

![image-20240902210148255](imgFiles/image-20240902210148255.png)

ä½¿ç”¨æ’ä»¶https://github.com/rt2zz/redux-persist

```jsx
npm install redux-persist

```

```jsx
// store
import { persistStore, persistReducer } from "redux-persist";
import storage from "redux-persist/lib/storage";

const persistConfig = {
  key: "root",
  storage,
  // ç™½åå• åªä¿å­˜ä»¥ä¸‹æ•°æ®
  whitelist: ["user"],
};

// æŒä¹…åŒ–reducer
const persistedReducer = persistReducer(persistConfig, rootReducer);

const store = configureStore({
  reducer: persistedReducer,
  // ä¸­é—´ä»¶å·²ç»é»˜è®¤åŒ…æ‹¬äº†redux-thunkï¼ŒactionLogä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ·»åŠ 
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware().concat(actionLog),
});
// æŒä¹…åŒ–stor
export const persistor = persistStore(store);

export default { store, persistor };
```

```jsx
// index.ts
import rootStore from "./redux/store";
import { PersistGate } from "redux-persist/integration/react"; 

//store
//persistor å‡æ¥è‡ªstore 
root.render(
  <Provider store={rootStore.store}>
    <PersistGate persistor={rootStore.persistor}>
      <App />
    </PersistGate>
  </Provider>
);
```

# ç§æœ‰è·¯ç”±ç³»ç»Ÿ

è®¢å•é¡µé¢éƒ½æ˜¯ç§æœ‰çš„ è¦ç”¨åˆ°ç§æœ‰è·¯ç”±

https://create-react-app.dev/docs/deployment



# éƒ¨ç½²æ–¹æ¡ˆ

![image-20240903212456200](imgFiles/image-20240903212456200.png)

```jsx
npm install -g serve
npm install
npm run build
serve -s build
```

ctrl + c åœæ­¢å‘½ä»¤

serve -s build -l 12231

Docker

![image-20240903213741828](imgFiles/image-20240903213741828.png)

![image-20240903213835150](imgFiles/image-20240903213835150.png)

# è®°å½•

`className={styles["App-header"]}`
è¿™ç§æ–¹å¼é€‚ç”¨äº CSS ä¸­å®šä¹‰çš„ç±»ååŒ…å«è¿å­—ç¬¦ `-` çš„æƒ…å†µã€‚åœ¨ JavaScript ä¸­,ä½¿ç”¨ç‚¹å· `.` æ¥å¼•ç”¨å±æ€§åç§°æ—¶,è¿å­—ç¬¦ `-` ä¼šè¢«è§£é‡Šä¸ºå‡æ³•æ“ä½œã€‚å› æ­¤,éœ€è¦ä½¿ç”¨æ–¹æ‹¬å· `[]` çš„å½¢å¼æ¥å¼•ç”¨è¿™ç§åŒ…å«è¿å­—ç¬¦çš„å±æ€§åã€‚

1. å¯¼å…¥module .css æ— æ³•è¯†åˆ«

   create `typings.d.ts` file in the current workspace.

   ```jsx
   declare module '*.css';
   declare module '*.less';
   declare module '*.png';
   declare module '*.svg' {
     export function ReactComponent(props: React.SVGProps<SVGSVGElement>): React.ReactElement
     const url: string
     export default url
   }
   ```

   åˆ›å»ºindex.d.ts åœ¨æ ¹ç›®å½•

   ```jsx
   declare module "*.scss" {
     const content: { [key: string]: any };
     export = content;
   }
   ```

   

2. min-height: 75vh;

- **min-height**: è¿™ä¸ªå±æ€§è®¾ç½®äº†å…ƒç´ çš„æœ€å°é«˜åº¦ã€‚
- **75vh**: `vh` æ˜¯ CSS ä¸­çš„ä¸€ä¸ªé•¿åº¦å•ä½,è¡¨ç¤ºè§†å£é«˜åº¦çš„ 1/100ã€‚ä¹Ÿå°±æ˜¯è¯´, `75vh` è¡¨ç¤ºå…ƒç´ çš„æœ€å°é«˜åº¦ä¸ºè§†å£é«˜åº¦çš„ 75%ã€‚

3. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨æ¥å£

   ```jsx
   interface PropsType {
     id: string | number;
     size: "large" | "small";
     imageSrc: string;
     price: number | string;
     title: string;
   }
   
   export const ProductImage: React.FC<PropsType> = ({
     id,
     size,
     imageSrc,
     price,
     title,
   }) => {
     return (
       <>
         {size === "large" ? (
           <Image src={imageSrc} height={285} width={485} />
         ) : (
           <Image src={imageSrc} height={120} width={240} />
         )}
         <div>
           <Typography.Text type="secondary">{title.slice(0, 25)}</Typography.Text>
           <Typography.Text type="danger" strong>
             Â¥ {price} èµ·
           </Typography.Text>
         </div>
       </>
     );
   };
   ```

4. è·¯ç”±

   ![image-20240828145737490](imgFiles/image-20240828145737490.png)

   ![image-20240828145834781](imgFiles/image-20240828145834781.png)

![image-20240828145852750](imgFiles/image-20240828145852750.png)

![image-20240828150258492](imgFiles/image-20240828150258492.png)

![image-20240828150337921](imgFiles/image-20240828150337921.png)

5. å®ç°è·¯ç”±å¸¦å‚æ•°ä¼ é€’

```jsx
<Route
  path="/detail/:touristRouteId/:other"
  element={<DetailPage />}
  />
```

åˆ©ç”¨`:/`

```jsx
è·¯å¾„ :/å‚æ•°1:/å‚æ•°2
```

ä½¿ç”¨useParamsè·å–ä¼ å‚

åœ¨useParamså‰ä½¿ç”¨<MatchParams>å®ç°ç±»å‹é€‚é…ï¼Œè¿™æ ·åœ¨è¾“å…¥parmas.åå°±ä¼šè‡ªåŠ¨è”æƒ³(æ–¹ä¾¿è¾“å…¥)

```tsx
type MatchParams = {
  touristRouteId: string;
  other: string;
};

export const DetailPage: React.FC = () => {
  let params = useParams<MatchParams>();
  return (
    <h1>
      æ—…æ¸¸è·¯çº¿è¯¦æƒ…é¡µé¢ï¼Œ è·¯çº¿ID: {params.touristRouteId}
      {params.other}
    </h1>
  );
};

```

6. 

åœ¨ ReactJS ä¸­ï¼Œæœ‰ä¸‰ç§ä¸åŒçš„é“¾æ¥æ ‡ç­¾, åˆ†åˆ«æ˜¯ï¼šNavLinkã€Link å’Œ a æ ‡ç­¾ã€‚

- NavLinkï¼šå½“ä½ æƒ³è¦çªå‡ºæ˜¾ç¤ºå½“å‰æˆ–æ´»åŠ¨é“¾æ¥æ—¶ä½¿ç”¨ï¼Œä¸€èˆ¬ä¸ activeClassName å±æ€§ä¸€èµ·ä½¿ç”¨ã€‚ è¯·å‚è§ä¸‹é¢çš„ç¤ºä¾‹ï¼š

```tsx
<NavLink to="/home" activeClassName="active" >Home</NavLink><br/>
```

```css
.active{
  color:red;
}
```

- Linkï¼šå½“é“¾æ¥æ²¡æœ‰ç‰¹æ®Šæ ·å¼æˆ–çªå‡ºæ˜¾ç¤ºæ—¶ä½¿ç”¨ã€‚ è¯·å‚è§ä¸‹é¢çš„ç¤ºä¾‹ã€‚

```jsx
<Link to="/not-active">Not Active </Link>
```

- é”šæ ‡ç­¾ aï¼šç”¨äºç½‘é¡µå¤–çš„é“¾æ¥ã€‚è¯·å‚è§ä¸‹é¢çš„ç¤ºä¾‹ã€‚

  

```jsx
<a href="https://baidu.com"> baidu </a>
```

æ³¨æ„ï¼šå¦‚æœéœ€è¦é“¾æ¥åˆ°å†…éƒ¨é¡µé¢æ—¶ï¼Œå¯ä»¥ä¼˜å…ˆä½¿ç”¨NavLink æˆ– Linkï¼› è€Œå¯¹äºå¤–éƒ¨é“¾æ¥ï¼Œa æ˜¯é¦–é€‰ã€‚

## Redux

Reduxæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼


![image-20240828173125273](imgFiles/image-20240828173125273.png)

![image-20240828173342502](imgFiles/image-20240828173342502.png)

![image-20240828173653479](imgFiles/image-20240828173653479.png)

é«˜é˜¶å‡½æ•° ä½¿ç”¨wtihå¼€å¤´

## `loading` çŠ¶æ€



åœ¨ Redux ä¸­ï¼Œå½“å¤„ç†å¼‚æ­¥æ“ä½œæ—¶ï¼Œé€šå¸¸ä¼šæœ‰å‡ ç§ä¸åŒçš„ `loading` çŠ¶æ€æ¥åæ˜ æ“ä½œçš„å½“å‰è¿›å±•ã€‚è¿™äº›çŠ¶æ€é€šå¸¸åŒ…æ‹¬ï¼š

### 1. **`idle`**

- **æè¿°**: åˆå§‹çŠ¶æ€ï¼Œè¡¨ç¤ºå½“å‰æ²¡æœ‰ä»»ä½•å¼‚æ­¥æ“ä½œæ­£åœ¨è¿›è¡Œã€‚é€šå¸¸ç”¨åœ¨å¼‚æ­¥æ“ä½œå°šæœªå¯åŠ¨æˆ–åˆšåˆšé‡ç½®æ—¶ã€‚
- **ç”¨é€”**: ç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦æ˜¾ç¤ºæŸäº›åˆå§‹å†…å®¹ï¼Œæˆ–è€…ç”¨äºè§¦å‘é¦–æ¬¡åŠ è½½ã€‚

### 2. **`pending`**

- **æè¿°**: è¡¨ç¤ºå¼‚æ­¥æ“ä½œæ­£åœ¨è¿›è¡Œä¸­ã€‚é€šå¸¸åœ¨è¯·æ±‚å‘é€åç«‹å³å°† `loading` çŠ¶æ€è®¾ç½®ä¸º `pending`ã€‚
- **ç”¨é€”**: ç”¨äºæ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨ï¼ˆä¾‹å¦‚ `spinner`ï¼‰ï¼Œå‘ŠçŸ¥ç”¨æˆ·æ­£åœ¨è·å–æ•°æ®æˆ–æ‰§è¡ŒæŸäº›æ“ä½œã€‚

### 3. **`fulfilled`**

- **æè¿°**: è¡¨ç¤ºå¼‚æ­¥æ“ä½œæˆåŠŸå®Œæˆå¹¶ä¸”æ•°æ®å·²æˆåŠŸè·å–æˆ–æ“ä½œæˆåŠŸæ‰§è¡Œã€‚
- **ç”¨é€”**: ç”¨äºéšè—åŠ è½½æŒ‡ç¤ºå™¨å¹¶æ˜¾ç¤ºè·å–åˆ°çš„æ•°æ®æˆ–æ“ä½œæˆåŠŸçš„ç»“æœã€‚

### 4. **`rejected`**

- **æè¿°**: è¡¨ç¤ºå¼‚æ­¥æ“ä½œå¤±è´¥ã€‚ä¾‹å¦‚ç½‘ç»œè¯·æ±‚å¤±è´¥æˆ–è€…æœåŠ¡å™¨è¿”å›é”™è¯¯ã€‚
- **ç”¨é€”**: ç”¨äºæ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ï¼Œå¹¶å…è®¸ç”¨æˆ·é‡è¯•æ“ä½œæˆ–è€…æ‰§è¡Œå…¶ä»–é”™è¯¯å¤„ç†é€»è¾‘ã€‚

### 5. **`loading` (è‡ªå®šä¹‰çŠ¶æ€)**

- æœ‰äº›åº”ç”¨ç¨‹åºå¯èƒ½ä¼šç®€å•åœ°ä½¿ç”¨ 

  ```
  true/false
  ```

   è¡¨ç¤ºæ­£åœ¨åŠ è½½ä¸å¦ã€‚è¿™æ—¶ï¼Œ

  ```
  loading
  ```

   çš„å€¼é€šå¸¸æ˜¯å¸ƒå°”ç±»å‹ï¼š

  - **`true`**: å¼‚æ­¥æ“ä½œæ­£åœ¨è¿›è¡Œã€‚
  - **`false`**: å¼‚æ­¥æ“ä½œå·²ç»“æŸï¼ˆæ— è®ºæˆåŠŸæˆ–å¤±è´¥ï¼‰ã€‚

åœ¨ä½¿ç”¨ `Redux Toolkit` æ—¶ï¼Œ`createAsyncThunk` é»˜è®¤ä¼šä¸ºä½ ç®¡ç†è¿™äº›çŠ¶æ€ï¼Œå¹¶å°† `pending`ã€`fulfilled` å’Œ `rejected` åŠ¨ä½œç±»å‹è‡ªåŠ¨ç”Ÿæˆå¹¶åˆ†æ´¾ç»™ä½ åœ¨ `extraReducers` ä¸­çš„å¤„ç†å‡½æ•°ã€‚ä½ å¯ä»¥åˆ©ç”¨è¿™äº›çŠ¶æ€æ¥æ§åˆ¶ç»„ä»¶çš„ UI æ˜¾ç¤ºé€»è¾‘ã€‚

![image-20240831150538656](imgFiles/image-20240831150538656.png)

## `type` & `interface`

**ä½¿ç”¨ `interface`**:

- å®šä¹‰å¯¹è±¡æˆ–ç±»çš„å½¢çŠ¶ï¼Œå¹¶ä¸”å¯èƒ½ä¼šå¯¹è¯¥å¯¹è±¡æˆ–ç±»è¿›è¡Œæ‰©å±•æˆ–ç»§æ‰¿ã€‚
- å¸Œæœ›åˆ©ç”¨å£°æ˜åˆå¹¶ç‰¹æ€§ã€‚
- åœ¨ä½¿ç”¨åº“ï¼ˆå¦‚ Reactï¼‰æ—¶ï¼Œé€šå¸¸ä¼šçœ‹åˆ°å¤§é‡çš„ `interface` å®šä¹‰ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦æ‰©å±•æ€§å’Œå£°æ˜åˆå¹¶èƒ½åŠ›ã€‚

**ä½¿ç”¨ `type`**:

- å®šä¹‰ç®€å•çš„å¯¹è±¡å½¢çŠ¶ï¼Œæˆ–å®šä¹‰è”åˆç±»å‹ã€äº¤å‰ç±»å‹ã€å…ƒç»„ç­‰å¤æ‚ç±»å‹ã€‚
- ä¸éœ€è¦å£°æ˜åˆå¹¶æˆ–ç»§æ‰¿ã€‚
- éœ€è¦æ›´çµæ´»çš„ç±»å‹å®šä¹‰ï¼Œä¾‹å¦‚å‡½æ•°ç±»å‹ã€è”åˆç±»å‹ã€äº¤å‰ç±»å‹ç­‰ã€‚

## å¦‚ä½•å®ç°`é¡µé¢åˆ‡æ¢`

```jsx
// SearchPage.tsx  
useEffect(() => {
    if (keywords) {
      dispatch(searchProduct({ keywords, nextPage: 1, pageSize: 10 }));
    }
  }, [location]);
  // è¡¨ç¤ºåªæœ‰urlå˜äº†æ‰ä¼šé‡æ–°è·å–æ•°æ®ï¼Œå› ä¸ºkeywordåœ¨urlä¸­ğŸ”´

  // åŒä¸€ä¸ªkeywords è¦æ˜¾ç¤ºä¸‹ä¸€é¡µæ•°æ®
  const onPageChange = (nextPage, pageSize) => {
    if (keywords) {
      dispatch(searchProduct({ nextPage, pageSize, keywords }));
    }
  };
```

åœ¨ä½ çš„ä»£ç ä¸­ï¼Œ`onPageChange` å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•° `nextPage` å’Œ `pageSize`ï¼Œå®ƒä»¬åº”è¯¥æ˜¯ç”± `ProductList` ç»„ä»¶é€šè¿‡åˆ†é¡µåŠŸèƒ½ä¼ é€’è¿‡æ¥çš„ã€‚

#### `onPageChange` å‚æ•°æ¥æº

é€šå¸¸æƒ…å†µä¸‹ï¼Œåˆ†é¡µåŠŸèƒ½ä¼šåœ¨åˆ—è¡¨ç»„ä»¶ä¸­å®ç°ï¼Œç±»ä¼¼äº `ProductList` è¿™æ ·çš„ç»„ä»¶ã€‚å®ƒå¯èƒ½åŒ…å«åˆ†é¡µæ§ä»¶ï¼Œæ¯”å¦‚ `antd` çš„ `Pagination` ç»„ä»¶æˆ–è€…ä½ è‡ªå®šä¹‰çš„åˆ†é¡µé€»è¾‘ã€‚`Pagination` ç»„ä»¶ä¼šåœ¨ç”¨æˆ·ç‚¹å‡»ä¸‹ä¸€é¡µæˆ–é€‰æ‹©é¡µé¢å¤§å°æ—¶è‡ªåŠ¨ä¼ é€’ `nextPage`ï¼ˆä¸‹ä¸€é¡µçš„é¡µç ï¼‰å’Œ `pageSize`ï¼ˆæ¯é¡µæ˜¾ç¤ºçš„äº§å“æ•°é‡ï¼‰ç»™ `onPageChange`ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœ `ProductList` ä½¿ç”¨äº† `antd` çš„ `Pagination`ï¼Œå®ƒå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```tsx
import { Pagination } from "antd";

export const ProductList: React.FC<{ data, paging, onPageChange }> = ({
  data,
  paging,
  onPageChange,
}) => {
  return (
    <div>
      {/* æ˜¾ç¤ºäº§å“åˆ—è¡¨ */}
      {data.map((product) => (
        <div key={product.id}>{product.name}</div>
      ))}

      {/* åˆ†é¡µæ§ä»¶ */}
      <Pagination
        current={paging.currentPage}
        total={paging.totalCount}
        pageSize={paging.pageSize}
        onChange={onPageChange}  // å½“é¡µç å˜åŒ–æ—¶è°ƒç”¨ onPageChange
      />
    </div>
  );
};
```

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`Pagination` ç»„ä»¶ä¼šè‡ªåŠ¨ä¼ é€’ `currentPage`ï¼ˆå³ `nextPage`ï¼‰å’Œ `pageSize` ç»™ `onPageChange` å‡½æ•°ã€‚å½“ç”¨æˆ·æ›´æ”¹é¡µç æ—¶ï¼Œå®ƒä¼šè§¦å‘ `onPageChange(nextPage, pageSize)`ï¼Œç„¶åè°ƒç”¨ `dispatch(searchProduct({ nextPage, pageSize, keywords }))` ä»¥è·å–æ–°é¡µçš„æ•°æ®ã€‚

#### å…·ä½“æ­¥éª¤
1. ç”¨æˆ·åœ¨ `ProductList` ä¸­ä½¿ç”¨åˆ†é¡µæ§ä»¶æ›´æ”¹é¡µç æˆ–é¡µé¢å¤§å°ã€‚
2. åˆ†é¡µæ§ä»¶ä¼šè§¦å‘ `onPageChange`ï¼Œä¼ é€’ `nextPage` å’Œ `pageSize` ä½œä¸ºå‚æ•°ã€‚
3. `onPageChange` å‡½æ•°è°ƒç”¨ `dispatch`ï¼Œé€šè¿‡ `searchProduct` è·å–æ–°çš„åˆ†é¡µæ•°æ®ã€‚

å› æ­¤ï¼Œ`nextPage` å’Œ `pageSize` æ˜¯ç”± `ProductList` ä¸­çš„åˆ†é¡µæ§ä»¶æ ¹æ®ç”¨æˆ·æ“ä½œä¼ é€’çš„ã€‚



## `æœç´¢é¡µé¢`çš„å®ç°

1. è·¯ç”±é…ç½®

```jsx
<Route path="/search/">
  <Route path=":keywords" element={<SearchPage />}></Route>
  <Route path="" element={<SearchPage />}></Route>
</Route>
```

2. è·å–è·¯ç”±ä¼ é€’çš„å‚æ•°

```jsx
const { keywords } = useParams<MatchParams>();
```

3. å‘é€å¼‚æ­¥è¯·æ±‚

   location è¡¨ç¤ºåªæœ‰urlå˜äº†æ‰ä¼šé‡æ–°è·å–æ•°æ®ï¼Œå› ä¸ºkeywordåœ¨urlä¸­

```jsx
  const dispatch = useAppDispatch();
  const location = useLocation();
  useEffect(() => {
    if (keywords) {
      dispatch(searchProduct({ keywords, nextPage: 1, pageSize: 10 }));
    }
  }, [location]);
```

4. Headerç»„ä»¶é…ç½®

```jsx
<Input.Search
	// æ–°æ·»åŠ ä»¥ä¸‹ä»£ç 
  onSearch={(keyword) => navigate("/search/" + keyword)}
  />
```

## HTTPçŠ¶æ€ç 

ä¸€ä¸ªä¸‰ä½æ•°å­—çš„çŠ¶æ€ç å’Œä¸€ä¸ªå­—ç¬¦ä¸²æ ¼å¼çŠ¶æ€æ¶ˆæ¯ç»„æˆ

![image-20240902183236690](imgFiles/image-20240902183236690.png)

![image-20240902183318597](imgFiles/image-20240902183318597.png)
